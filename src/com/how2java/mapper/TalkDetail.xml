<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

	<mapper namespace="com.how2java.mapper.TalkDetailMapper">
	    

	<!-- 	            加载楼层 -->
		<select id="listdetail"    resultType="TalkDetail">
			SELECT *FROM talkdetail_ Where talkid = ${talkid} order by sort asc
		</select>

<!-- 		寻找帖子id -->
		<select id="gettalkid"     resultType="TalkDetail">
			SELECT id AS talkid FROM talk_   WHERE id= ${talkid}
		</select>	
		
		
		
		
		<!-- 举报某评论 -->
<update id="jubao" parameterType="int">
update talkdetail_ set reported=1 where id=#{id}
</update>


<!--加载被举报的评论  -->
<select id="chuli" resultType="com.how2java.pojo.TalkDetail">
select * from talkdetail_ where reported=1
</select>
<!--举报为实，修改评论 -->
<update id="pingbifayan" >
update talkdetail_ set authortext=#{0},reported=2 where id=#{1}
</update>
<!--已经被认定为违规的言论  -->
<select id="reported" resultType="com.how2java.pojo.TalkDetail">
select * from talkdetail_ where reported=2;
</select>
<!-- 发言 -->
<insert id="fayan" parameterType="com.how2java.pojo.TalkDetail">
INSERT into talkdetail_ (authorname,authorphoto,authortext,img,sort,talkid)values
(#{authorname},#{authorphoto},#{authortext},#{img},#{sort},#{talkid})
</insert>
		
		<update id="updatetime" >
		update talkdetail_ set writetime=#{0} where sort=#{1}
		</update>
		
		<select id="max"  resultType="Integer">
		select MAX(sort) from talkdetail_ WHERE talkid=#{talkid}
		</select>
		
		
		
	</mapper>